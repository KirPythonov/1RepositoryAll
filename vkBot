import vk_api
import time
import random
import pyowm
import json

owm = pyowm.OWM('6d00d1d4e704068d70191bad2673e0cc', language="ru")

place = "–¢—É–ª–∞"

observation = owm.weather_at_place(place)

w = observation.get_weather()

temp = w.get_temperature('celsius')['temp']

wt = w.get_detailed_status()

if wt == "—è—Å–Ω–æ":
    k = "‚òÄ"
    l = "‚òÄ"
elif wt == "–ø–∞—Å–º—É—Ä–Ω–æ":
    k = "üå•"
    l = "üå•"
elif wt == "–Ω–µ–±–æ–ª—å—à–æ–π –¥–æ–∂–¥—å":
    k = "üåß"
    l = "‚òÇ"
elif wt == "–º–≥–ª–∞":
    k = "üå´"
    l = "üå´"
elif wt == "–Ω–µ–±–æ–ª—å—à–æ–π —Å–Ω–µ–≥–æ–ø–∞–¥":
    k = "üå®"
    l = "üå®"
elif wt == "–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å":
    k = "üå§"
    l = "üå§"
elif wt == "–æ–±–ª–∞—á–Ω–æ —Å –ø—Ä–æ—è—Å–Ω–µ–Ω–∏—è–º–∏":
    k = "üå§"
    l = "üå§"
elif wt == "–Ω–µ–±–æ–ª—å—à–æ–π —Å–Ω–µ–≥":
    k = "‚ùÑ"
    l = "‚ùÑ"

if 0 < temp < 5:
    f = "–•–æ–ª–æ–¥–Ω–æ–≤–∞—Ç–æ, –Ω–æ –∂–∏—Ç—å –º–æ–∂–Ω–æ"
elif temp < 0:
    f = "‚ùÑ–°–µ–≥–¥–Ω—è –Ω–µ —Å–∞–º—ã–π –ª—É—á—à–∏–π –¥–µ–Ω—å —á—Ç–æ–±—ã –∫—É–¥–∞-—Ç–æ –≤—ã—Ö–æ–¥–∏—Ç—å‚õÑ"
elif 12 > temp > 5:
    f = "–°–µ–≥–æ–¥–Ω—è –º–æ–∂–Ω–æ –∏ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å"
else:
    f = "üî•–û—á–∏–Ω—å —Ç–µ–ø–ª–æüî•"

token = "1a04ad619f7f7426fadb651cd0480819a6604b0dc4653ae25beda435146db7fb10088f3396cf25698ae0c"

vk = vk_api.VkApi(token=token)
vk._auth_token()


def get_button(label, color, payload=""):
    return {
        "action": {
            "type": "text",
            "payload": json.dumps(payload),
            "label": label
        },
        "color": color
    }


keyboard = {
    "one_time": False,
    "buttons": [
        [get_button(label="—ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", color="default")],
        [get_button(label="–ø–æ–≥–æ–¥–∞", color="primary"), get_button(label="‚úÖ–¥–∞–ª—å—à–µ‚úÖ", color="positive")],  # –ú–ï–ô–ù –ú–ï–ù–Æ
        [get_button(label="‚úÖ—Å–∫–≤–∞–¥96‚úÖ", color="primary"), ]
    ]
}

keyboard = json.dumps(keyboard, ensure_ascii=False).encode('utf-8')
keyboard = str(keyboard.decode('utf-8'))

keyboardd = {
    "one_time": False,
    "buttons": [
        [get_button(label="‚õî–≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é‚õî", color="negative"), get_button(label="–ø—É–∫", color="primary")],
        # –í–¢–û–†–û–ï –ú–ï–ù–Æ
        [get_button(label="–∫—Ç–æ —è?", color="primary"), get_button(label="–ø—Ä–∏–≤–µ—Ç –ª—É–Ω—Ç–∏–∫", color="primary"),
         get_button(label="–≥–¥–µ —è?", color="primary")],
        [get_button(label="–∫—É", color="primary"), get_button(label="–ø—Ä–∏–≤–µ—Ç", color="default"),
         get_button(label="–∂–æ–ø–∞", color="primary")]
    ]
}

keyboardd = json.dumps(keyboardd, ensure_ascii=False).encode('utf-8')
keyboardd = str(keyboardd.decode('utf-8'))

keyboarddd = {
    "one_time": False,
    "buttons": [
        [get_button(label="üî•—Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤üî•", color="primary"), get_button(label="‚úÖ–¥–∞–ª—å—à–µ‚úÖ", color="positive")],
        # –°–ö–í–ê–î96 –ì–†–£–ü–ü–ê
        [get_button(label="üîî–∫–æ–º–º–∞–Ω–¥—ã –±–æ—Ç–∞üîî", color="primary"),
         get_button(label="üí¨–ø–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏üí¨", color="primary")]
    ]
}

keyboarddd = json.dumps(keyboarddd, ensure_ascii=False).encode('utf-8')
keyboarddd = str(keyboarddd.decode('utf-8'))

while True:
    try:
        messages = vk.method("messages.getConversations", {"offset": 0, "count": 20, "filter": "unanswered"})
        if messages["count"] >= 1:
            id = messages["items"][0]["last_message"]["from_id"]
            body = messages["items"][0]["last_message"]["text"]
            if body.lower() == "–ø—Ä–∏–≤–µ—Ç –ª—É–Ω—Ç–∏–∫":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ù—É –∑–¥–∞—Ä–æ–≤–∞ –º–∞—Å–ª—ë–Ω–æ–∫, –Ω–∞–¥–µ—é—Å—å –ª–∞–π–∫–∏ –Ω–∞ –ø–æ—Å—Ç—ã —Å—Ç–∞–≤–∏—à—å,–∏–Ω–∞—á–µ –º–Ω–µ –ø—Ä–∏–¥—ë—Ç—Å—è —Ç–µ–±—è —É–¥–∞—Ä–∏—Ç—å",
                                            "random_id": random.randint(1, 2147483647)})
            elif body.lower() == "–∫—Ç–æ —è?":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–¢—ã —É—á–∞—Å—Ç–Ω–∏–∫ –≥—Ä—É–ø–ø—ã –°–∫–≤–∞–¥96, –µ—Å–ª–∏ —Ç–µ–±–µ —Ö–æ—á–µ—Ü–∞ –Ω–µ–º–Ω–æ–≥–∞ —Ä–æ—Ñ–ª–∞, —Ç–æ–≥–¥–∞ —Ç–µ–±–µ –∫ –Ω–∞–º <3",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–∫—É":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ö–£ –ö–£ –¥—É—Ä–∞–∫, —á—ë —Ç—ã –∫–∞–∫ –±–µ—à–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä–æ–≤–∞—Ä–∏–≤–∞–µ—à—å, –ø–∏—à–∏ –∫–∞–∫ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∞ –Ω–µ –∫—É–∫–∞—Ä–µ–∫–∞–π",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–∂–æ–ø–∞":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ö–∞–∫–æ–π –æ—Ç–≤–µ—Ç —Ç—ã –æ–∂–∏–¥–∞–ª –ø–æ–ª—É—á–∏—Ç—å??? —Ç–≤–æ–π —É—Ä–æ–≤–µ–Ω—å IQ —è–≤–Ω–æ —Å—Ä–∞–≤–Ω–∏–º —Å —Ç–∞–±—É—Ä–µ—Ç–∫–æ–π",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–∫–∞–∫ –¥–µ–ª–∞?":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–û—Ç–ª–∏—á–Ω–æ, —è —Ä–∞–∑–≤–∏–≤–∞—é—Å—å –∏ —Å—Ç–∞–Ω–æ–≤–ª—é—Å—å –ª—É—á—à–µ –∏ —É–º–Ω–µ–µ –¥–µ–Ω—å –∑–∞ –¥–Ω—ë–º\n –ê —É —Ç–µ–±—è –∫–∞–∫ –¥–µ–ª–∞? =)",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–ø—Ä–∏–≤–µ—Ç":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ü—Ä–∏–≤–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –∂–æ–¥–∂–æ—Ä–∏–∞–Ω, –º–µ–Ω—è –∑–æ–≤—É—Ç –ë–û–¢–ª—É–Ω—Ç–∏–∫ –∏ —è –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–≥–æ–¥—É, —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –∏ –µ—â—ë –º–Ω–æ–≥–æ —á–µ–≥–æ, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–∞–π—Å—è —Å–æ –º–Ω–æ–π –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π –ª–∞–π–∫–∞—Ç—å –ø–æ—Å—Ç—ã –≤ –≥—Ä—É–ø–ø–µ ",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "—Ç—ã –¥–∞—É–Ω":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ó–∞—Ç–∫–Ω–∏—Å—å, –∂–µ—Ä—Ç–≤–∞ –∏–Ω—Ü–µ—Å—Ç–∞. –¢–µ–±–µ –ø–æ–≤–µ–∑–ª–æ, —á—Ç–æ —Ç–≤–æ—è –º–∞—Ç—å –∑–∞–±—Ä–∞–ª–∞ —Ç–µ–±—è –∏–∑ –¥–µ—Ç–¥–æ–º–∞, —Å—É—á—ë–Ω–æ–∫",
                                            "random_id": random.randint(1, 2147483647)})

            # elif body.lower() == "üåß–ø–æ–≥–æ–¥–∞‚òÄ":
            # vk.method("messages.send", {"peer_id": id, "message": "–°–µ–≥–æ–¥–Ω—è –ø–æ–≥–æ–¥–∞ –≤ –¢—É–ª–µ: " + k + str(wt) + l + "\n" + "–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ä–∞–≤–Ω–∞: " + str(temp) + "–≥—Ä–∞–¥—É—Å–∞–º \n" + f, "random_id": random.randint(1, 2147483647)})
            elif body.lower() == "–ø–æ–≥–æ–¥–∞":
                vk.method("messages.send", {"peer_id": id, "message": "–°–µ–≥–æ–¥–Ω—è –ø–æ–≥–æ–¥–∞ –≤ –¢—É–ª–µ: " + k + str(
                    wt) + l + "\n" + "–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ä–∞–≤–Ω–∞: " + str(temp) + "–≥—Ä–∞–¥—É—Å–∞–º \n" + f,
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–ø—É–∫":
                vk.method("messages.send",
                          {"peer_id": id, "message": "üóØ–ü—É–∫–Ω—É–ªüóØ", "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–∏–¥–∏ –Ω–∞—Ö—É–π":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ò–¥–∏ –Ω–∞—Ö—É–π —Ç—ã —Å—É–∫–∞ –≤–∞–Ω—é—á–∏–π –∫–∞–ª–ª –∏–∑ –∂–æ–ø—ã —Ç—ã –æ–±—Ä—ã–≥–∞–Ω—ã–π –æ–ª–µ–Ω—å —Å—É–∫–∞ –≥–µ–π –¥–µ–Ω—å—á–∏–∫ –ø–æ–ª–æ–≤–æ–π —Å–∏–Ω–¥—Ä–æ–º –ø–∞—Ç–∞—É –¥–æ–¥–∏–∫ ",
                                            "random_id": random.randint(1, 2147483647)})
            elif body.lower() == "–ø–æ—à—ë–ª –Ω–∞ —Ö—É–π":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–ü–æ—à—ë–ª –Ω–∞ —Ö—É–π —Å–∞–º —Ç—ã —Å—É–∫–∞ –≤–∞–Ω—é—á–∏–π –∫–∞–ª–ª –∏–∑ –∂–æ–ø—ã —Ç—ã –æ–±—Ä—ã–≥–∞–Ω—ã–π –æ–ª–µ–Ω—å —Å—É–∫–∞ –≥–µ–π –¥–µ–Ω—å—á–∏–∫ –ø–æ–ª–æ–≤–æ–π —Å–∏–Ω–¥—Ä–æ–º –ø–∞—Ç–∞—É –¥–æ–¥–∏–∫ –ø–∞–¥–∞–ª—å –≥–Ω–∏–ª—å",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "—Ö—É–π":
                vk.method("messages.send", {"peer_id": id, "message": "–¢–µ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ? –∏–¥–∏ –∑–∞–π–º–∏—Å—å –¥–µ–ª–æ–º",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "—ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é":
                vk.method("messages.send",
                          {"peer_id": id, "message": "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≤—ã –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –ø–æ–∑–∂–µ",
                           "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "–≥–¥–µ —è?":
                vk.method("messages.send", {"peer_id": id, "message": "–¢—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, –ø–µ—Ä–µ–¥–∞–π –ø—Ä–∏–≤–µ—Ç –†–û–°–ö–û–ú–ù–ê–î–ó–û–†–£!",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "üí¨–ø–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏üí¨":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–¢—É—Ç –º–æ–≥–ª–∞ –±—ã—Ç—å —Ç–≤–æ—è —Ä–µ–∫–ª–∞–º–∞, –Ω–æ –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é —É —Ç–µ–±—è –Ω–µ—Ç –¥–µ–Ω—è–∫ (-_-)\n —Ç–∞–∫–∂–µ —Ç—ã –º–æ–∂–µ—à—å –Ω–∞ –¥–æ—Å—É–≥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å JOJO - https://jut.su/jojo-bizarre-adventure",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "üîî–∫–æ–º–º–∞–Ω–¥—ã –±–æ—Ç–∞üîî":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "| –ø—Ä–∏–≤–µ—Ç –ª—É–Ω—Ç–∏–∫ | –∫—Ç–æ —è? | –∫–∞–∫ –¥–µ–ª–∞? | –ø—É–∫ | –≥–¥–µ —è? | \n |  –∫—É | –ø–æ–≥–æ–¥–∞ | üí¨–ø–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏üí¨| \n | üîî–∫–æ–º–º–∞–Ω–¥—ã –±–æ—Ç–∞üîî | üî•—Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤üî• |\n ""–ù–∞ —ç—Ç–æ–º –∫–æ–º–º–∞–Ω–¥—ã –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è, —Ç—ã –≤—Å—ë –µ—â—ë –º–æ–∂–µ—à—å –ø–æ—Å–ª–∞—Ç—å –±–æ—Ç–∞ –µ—Å–ª–∏ —Ç–µ–±–µ –≤–¥—Ä—É–≥ –∑–∞—Ö–æ—Ç–µ–ª–æ—Å—å",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "üî•—Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤üî•":
                vk.method("messages.send", {"peer_id": id,
                                            "message": "–°–∞–Ω—è-–≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Äüêî\n –î–µ–Ω—å—á–∏–∫-–º–æ–¥–µ—Ä–∞—Ç–æ—Ä(—á–∏—Å—Ç–æ —Ä–æ—Ñ–ª)ü§°\n –ù–∏–∫–∏—Ç–∞ –ë–∞—Ä–∞–Ω–æ–≤-—Ä–µ–¥–∞–∫—Ç–æ—Äüòé\n –ö–∏—Ä–∏–ª–ª –ì—É—Å—å–∫–æ–≤-—Å–æ–∑–¥–∞—Ç–µ–ª—å –±–æ—Ç–∞üòé\n –õ–µ–Ω–∞ –ü–∞–∫–∏–¥–æ–≤–∞-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Äüî•\n –í–æ–≤–∞–Ω –ì—É—Å—å–∫–æ–≤-—Ä–µ–¥–∞–∫—Ç–æ—Äüòé",
                                            "random_id": random.randint(1, 2147483647)})
            elif body.lower() == "–Ω–∞—á–∞—Ç—å":
                vk.method("messages.send", {"peer_id": id, "keyboard": keyboard, "message": "–ß–ò–ö-–ë–ó–î–´–ö",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "‚úÖ–¥–∞–ª—å—à–µ‚úÖ":
                vk.method("messages.send", {"peer_id": id, "keyboard": keyboardd, "message": "–ß–ò–ö-–ë–ó–î–´–ö",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "‚úÖ—Å–∫–≤–∞–¥96‚úÖ":
                vk.method("messages.send", {"peer_id": id, "keyboard": keyboarddd, "message": "–ß–ò–ö-–ë–ó–î–´–ö",
                                            "random_id": random.randint(1, 2147483647)})

            elif body.lower() == "‚õî–≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é‚õî":
                vk.method("messages.send", {"peer_id": id, "keyboard": keyboard, "message": "–ß–ò–ö-–ë–ó–î–´–ö",
                                            "random_id": random.randint(1, 2147483647)})
    except Exception as E:
        time.sleep(1)

        # –≠–¢–û –ó–ê–ü–£–°–ö –ö–û–î–ê –∑–∞–±—ã–ª –Ω–∞–≤–µ—Ä–Ω–æ–µ –∫–∞–∫ —ç—Ç—É –¥—É—Ä—É –∑–∞–ø—É—Å–∫–∞—Ç—å, –¥–∞? -->

        # cd C:\bot
        # python vk.py
